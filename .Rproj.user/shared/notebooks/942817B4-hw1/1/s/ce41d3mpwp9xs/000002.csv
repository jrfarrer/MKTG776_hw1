"0","estimation <-"
"0","  param_history %>%"
"0","  mutate("
"0","    density = map2(alpha, beta, function(.x, .y) {rbeta(10000, .x, .y)})"
"0","  ) %>%"
"0","  mutate("
"0","    label1 = paste0(""atop(alpha == "", formatC(alpha, digits = 2, format = 'f'), "
"0","                     ',beta == ', formatC(beta, digits = 2, format = 'f'),')')"
"0","    , label2 = paste0('E(theta) == ', formatC(alpha / (alpha + beta), digits = 2, format = 'f'))"
"0","  )"
"0","estimation %>%"
"0","  unnest() %>%"
"0","  ggplot(aes(x = density, colour = calibration, fill = calibration)) +"
"0","  geom_density(alpha = 1/3) +"
"0","  facet_grid( forcats::fct_rev(calibration) ~ forcats::fct_rev(customer_type)) +"
"0","  theme(legend.position = 'none') +"
"0","  geom_text(data = estimation, aes(x = .75, y = 4, label = label1), parse = TRUE) +"
"0","  geom_text(data = estimation, aes(x = .75, y = 3, label = label2), parse = TRUE) +"
"0","  labs(x = expression(theta), y = expression(f(theta)))"
